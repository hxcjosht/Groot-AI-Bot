import speech_recognition as sr
from pygame import mixer
import random
import RPi.gpio as GPIO
from time import sleep


#Body of Groot Movements

GPIO.setmode(GPIO.BOARD)
GPIO.setup(11, GPIO.OUT)
GPIO.setup(14, GPIO.OUT)

up= 2.5
down=12
neutral= 7.5
left=1
right=15

arm=GPIO.PWM(11,50)
head=GPIO.PWM(14,50)
def movement():
    arm.ChangeDutyCycle(up)
    head.ChangeDutyCycle(left)
    sleep(.1)
    arm.ChangeDutyCycle(down)
    head.ChangeDutyCycle(right)
    sleep(.1)
    arm.ChangeDutyCycle(neutral)
    head.ChangeDutyCycle(neutral)



#Groot Audio and Responses
soundboard=[""]

mixer.init()

def groot_voice():
    voice= soundboard[random.randrange(0,4)]
    mixer.music.load(voice)
    mixer.music.play()


def get_audio():
    r = sr.Recognizer()
    with sr.Microphone() as source:
        audio = r.listen(source)
        said = ""

        try:
            said = r.recognize_google(audio)
            print(said)
        except Exception as e:
            print("Exception: " + str(e))

    return said.lower()



WAKE = "groot"
print("Start")

while True:
    print("Listening")
    text = get_audio()

    if text.count(WAKE) > 0:
        groot_voice()
        movement()
        
